{
  "db_name": "PostgreSQL",
  "query": "\n            WITH latest_block_numbers AS (\n                SELECT account_address, idx, MAX(block_number) as block_number\n                FROM historical_slots\n                GROUP BY idx, account_address\n            ),\n            latest_slots AS (\n                SELECT account_slots.account_address, historical_slots.idx, historical_slots.value\n                FROM account_slots\n                JOIN latest_block_numbers\n                ON latest_block_numbers.account_address = account_slots.account_address\n                    AND account_slots.idx = latest_block_numbers.idx\n                LEFT JOIN historical_slots ON account_slots.account_address = historical_slots.account_address\n                    AND latest_block_numbers.block_number = historical_slots.block_number\n              \t\tAND account_slots.idx = historical_slots.idx\n            )\n            UPDATE account_slots\n            SET value = latest_slots.value\n            FROM latest_slots\n            WHERE latest_slots.account_address = account_slots.account_address\n                AND latest_slots.idx = account_slots.idx\n                AND latest_slots.value IS DISTINCT FROM account_slots.value",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": []
    },
    "nullable": []
  },
  "hash": "582c5ae4cc4778461adbdf7e15448061fde3fadad738dad944ae7ae9d3b4aa21"
}
