{
  "db_name": "PostgreSQL",
  "query": "\n            -- Get the block_numbers with the latest balance change for each address\n            WITH latest_block_numbers AS (\n                SELECT address, MAX(block_number) as block_number\n                FROM historical_balances\n                GROUP BY address\n            ),\n            -- Get the latest balance change for each address\n            latest_balances AS (\n                SELECT accounts.address, historical_balances.balance\n                FROM accounts\n                JOIN latest_block_numbers\n                ON latest_block_numbers.address = accounts.address\n                LEFT JOIN historical_balances on accounts.address = historical_balances.address\n                    AND latest_block_numbers.block_number = historical_balances.block_number\n            )\n            -- Update the accounts with the balances in latest_balances\n            UPDATE accounts\n            SET latest_balance = latest_balances.balance\n            FROM latest_balances\n            WHERE latest_balances.address = accounts.address\n                AND latest_balances.balance IS DISTINCT FROM accounts.latest_balance",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": []
    },
    "nullable": []
  },
  "hash": "438424c6c2ece93c1a17f32dfc21f91808442e380565f7cb6cbd79acd487c34b"
}
