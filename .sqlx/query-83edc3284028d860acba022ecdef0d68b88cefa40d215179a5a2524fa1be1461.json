{
  "db_name": "PostgreSQL",
  "query": "\n            WITH latest_block_numbers AS (\n                SELECT address, MAX(block_number) as block_number\n                FROM historical_balances\n                GROUP BY address\n            ),\n            latest_balances AS (\n                SELECT accounts.address, historical_balances.balance\n                FROM accounts\n                JOIN latest_block_numbers\n                ON latest_block_numbers.address = accounts.address\n                LEFT JOIN historical_balances on accounts.address = historical_balances.address\n                    AND latest_block_numbers.block_number = historical_balances.block_number\n            )\n            UPDATE accounts\n            SET latest_balance = latest_balances.balance\n            FROM latest_balances\n            WHERE latest_balances.address = accounts.address\n                AND latest_balances.balance IS DISTINCT FROM accounts.latest_balance",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": []
    },
    "nullable": []
  },
  "hash": "83edc3284028d860acba022ecdef0d68b88cefa40d215179a5a2524fa1be1461"
}
